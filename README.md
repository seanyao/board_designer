# 板子设计器 (Board Designer)

一个基于 Web 的 PC 板设计小工具，支持创建和管理 M3 孔位组与零件，具备直观的网格对齐拖拽、边长/尺寸标注、右键创建、自动保存与文件导入导出等功能。

## ✨ 主要功能

### 🎯 孔位与零件
- **右键创建**：在画布上右键，选择要创建的对象
  - 创建 4 孔位的矩形“孔位组”（M3）
  - 创建半透明灰色“零件”矩形
- **拖拽移动**：孔位可单独拖动；零件整体可拖动
- **删除孔位组**：双击任一孔位 -> 确认后删除整组
- **尺寸限制**：默认创建尺寸/间距均为 5 mm 的整数倍
  - 孔位组默认边长 20 mm
  - 零件默认 40 × 30 mm

### 📐 尺寸标注
- **孔位组边长**：四边均显示长度（mm）
- **零件尺寸**：矩形中心显示“长 × 宽 mm”
- **外框尺寸**：画布顶部显示宽度，右侧显示高度（mm，显示在框外）
- **实时更新**：拖拽/缩放时，标注自动更新

### 🧭 右键度量工具（新增）
- **创建长度度量**：右键菜单选择“创建长度度量”
  - 第一次点击选择起点
  - 第二次点击选择终点
- **显示效果**：两点虚线连接，线上中点显示长度（mm）
- **网格对齐**：起止点自动对齐 5 mm 网格

### ↔️ 边缘缩放（新增）
- **零件矩形**：可拖拽四角手柄，以及四条边手柄（n/e/s/w）进行缩放
- **孔位组矩形**：可拖拽四条边手柄（n/e/s/w）整体改变组的矩形尺寸，四个孔保持位于四角
- **对齐与边界**：所有缩放/移动均对齐 5 mm 网格，并受画布范围限制

### 💾 保存与恢复（新增）
- **自动保存**：操作后自动将设计保存到浏览器 localStorage（键：`designer-autosave-v1`）
- **启动恢复**：打开页面自动尝试恢复上次进度
- **导出文件**：一键导出 JSON 文件，文件名包含时间戳（如 `design-20250101-123045.json`）
- **从文件加载**：选择本地 JSON 文件即可恢复设计
- **说明**：浏览器无法直接写入 HTML 同级目录，导出采用下载方式

### 🎨 视觉特性
- **多组颜色**：不同孔位组使用不同颜色
- **网格背景**：5 mm 网格，辅助对齐
- **虚线边**：孔位组、长度度量均使用虚线表现

## 🚀 使用方法

1. 在浏览器中打开 `designer.html`
2. 在画布上右键，选择：
   - 创建孔位组（4 个 M3）
   - 创建零件（矩形）
   - 创建长度度量（两次点击确定起止点）
3. 拖动孔位或零件进行布局；拖拽边/角手柄进行缩放
4. 如需删除孔位组，双击任一孔位并确认
5. 使用左上角工具栏保存/导入：
   - 保存到文件（下载 JSON）
   - 从文件加载（选择 JSON）
   - 清除/恢复自动保存

## 🧩 技术规格
- 画布尺寸：17 cm × 17 cm
- 网格精度：5 mm（所有默认尺寸/变更对齐网格）
- 孔位规格：M3（孔可拖拽，组显示四边长度）
- 默认孔位组：边长 20 mm
- 默认零件：40 × 30 mm（半透明灰色，边框描边）

## 🛠️ 技术实现
- 纯前端：HTML5 + CSS3 + JavaScript
- 右键菜单 + 键盘 ESC 取消操作
- 像素 → 毫米换算，显示值四舍五入
- 自动保存（localStorage）与导入/导出（JSON Blob）

## 📁 项目结构

```
designer/
├── designer.html    # 主程序
└── README.md        # 项目说明
```

## 📝 更新日志（近期）
- ✅ 创建方式改为右键菜单
- ✅ 新增“零件”中心尺寸标签（长 × 宽 mm）
- ✅ 新增边缘缩放：零件（四角+四边）、孔位组（四边）
- ✅ 默认尺寸/间距改为 5 mm 整数倍（孔位组 20 mm，零件 40 × 30 mm）
- ✅ 外框尺寸标签显示在框外
- ✅ 自动保存与启动恢复，导出/导入 JSON 文件
- ✅ 新增“长度度量”工具：两点虚线 + 中点显示 mm 长度

## 🤝 贡献
欢迎提交 Issue / Pull Request 改进这个工具。

## 📄 许可证
MIT License - 可自由使用和修改
